# 実装計画メモ

## 完了した項目

1. フォーム UI の刷新  
   - 従来の自由入力チャットを閲覧専用にし、モードごとの入力フィールドを整備。  
   - クライアント側バリデーションとエラーメッセージ表示を追加。  
   - 送信値から JSON ペイロードを生成してワーカーへ送る経路を構築。
2. チャット表示と操作系の整理  
   - 送信ボタンを廃止し、フォーム内に停止ボタンを配置。  
   - 自動テスト経路をフォーム送信に合わせて更新。  
   - 直近入力を保持できるようフォーム値の再描画処理を追加。
3. ワーカーロジックの単純化  
   - ReAct ベースのレガシー処理を撤廃し、構造化タスクのみを受け付けるよう統一。  
   - フォーム固有フィールド（`sheet_name`, `source_reference_urls` など）の読み取りと検証を整理。  
   - Excel 側エラーや Copilot 応答失敗を UI へ適切に伝達するよう例外処理を強化。
4. ドキュメント更新  
   - `PROGRAM_SPEC.md` をフォーム運用前提に差し替え。  
   - 実装メモをフォーム版の観点に合わせて整理。

## 今後の TODO

- 代表的なフォーム入力ケースの自動テストを追加（検証スクリプトの整備）。
- フォーム定義やデフォルト値を設定ファイル化し、運用時のカスタマイズを容易にする。
- 参照ファイルのパス入力 UX を改善し、ドラッグ&ドロップや最近使用した項目の選択を検討。
